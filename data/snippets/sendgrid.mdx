// File: /api/sendgrid.js

import sendgrid from "@sendgrid/mail";

sendgrid.setApiKey(process.env.SENDGRID_API_KEY);

export default async function handler(req, res) {
  if (req.method !== "POST") {
    return res.status(405).json({ error: "Method not allowed" });
  }

  const { email } = req.body;

  if (!email) {
    return res.status(400).json({ error: "Email is required" });
  }

  try {
    await sendgrid.send({
      to: email,
      from: "manuarorawork@gmail.com", // âœ… Replace with verified sender email
      subject: "Greetings ! Thank you for contacting me",
      html: `
        <!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <title>Thank You</title>
        </head>
        <body style="font-family: Helvetica, Arial, sans-serif;">
          <div style="padding: 20px;">
            <h3>Hello, ${email} ðŸ‘‹</h3>
            <p>Thank you for contacting me through my website. I'm excited to work with you.</p>
            <p><strong>Reply</strong> to this email with your requirements and I will get back to you.</p>
            <p>Meanwhile, <a href="https://manuarora.in/blog/" style="color: blue; font-weight: bold;">check out my blog</a> to get more insights about my work.</p>
            <p>Or just say Hi ðŸ™‚ on 
              <a href="https://wa.me/919587738861?text=Hi" target="_blank" style="background-color: #10B981; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none;">
                WhatsApp
              </a>
            </p>
            <br>
            <img src="https://manuarora.in/logo.png" alt="Logo" style="height: 50px; width: 50px; border-radius: 5px;">
            <p style="font-size: 16px; padding-bottom: 20px; border-bottom: 1px solid #D1D5DB;">
              Regards,<br>Manu Arora<br>Software Developer<br>+91 9587738861
            </p>
            <div style="margin-top: 20px; text-align: center; color: #9CA3AF;">
              <a href="https://manuarora.in/" style="margin: 0 8px; color: #9CA3AF;">Website</a>
              <a href="https://manuarora.in/blog/" style="margin: 0 8px; color: #9CA3AF;">Blog</a>
              <a href="https://github.com/manuarora700/" style="margin: 0 8px; color: #9CA3AF;">GitHub</a>
              <a href="https://instagram.com/maninthere/" style="margin: 0 8px; color: #9CA3AF;">Instagram</a>
              <a href="https://linkedin.com/in/manuarora28/" style="margin: 0 8px; color: #9CA3AF;">LinkedIn</a>
              <a href="https://twitter.com/mannupaaji/" style="margin: 0 8px; color: #9CA3AF;">Twitter</a>
            </div>
          </div>
        </body>
        </html>
      `,
    });

    return res.status(200).json({ message: "Email sent successfully" });
  } catch (error) {
    console.error("SendGrid Error:", error);
    return res.status(error.statusCode || 500).json({ error: error.message });
  }
}
